# Rumplay - Apache Configuration for API
# Place this file in public_html/api/.htaccess

# Enable mod_rewrite
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /api/
</IfModule>

# Set correct MIME types for JSON
<IfModule mod_mime.c>
    AddType application/json .json
</IfModule>

# Security Headers
<IfModule mod_headers.c>
    # CORS Headers (Allow all origins for development)
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
    Header always set Access-Control-Max-Age "3600"
    
    # Handle OPTIONS requests
    RewriteCond %{REQUEST_METHOD} OPTIONS
    RewriteRule ^(.*)$ $1 [R=200,L]
    
    # Security headers
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# PHP Configuration
<IfModule mod_php8.c>
    # Increase upload limits
    php_value upload_max_filesize 100M
    php_value post_max_size 100M
    php_value max_execution_time 300
    php_value max_input_time 300
    php_value memory_limit 256M
    
    # Error reporting (disable in production)
    php_value display_errors 1
    php_value display_startup_errors 1
    php_value error_reporting E_ALL
</IfModule>

# Directory Protection
<IfModule mod_autoindex.c>
    Options -Indexes
</IfModule>

# File Protection
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|sql)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Cache Control for API responses
<IfModule mod_expires.c>
    ExpiresActive Off
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
</IfModule>

# Error Documents
ErrorDocument 404 "API endpoint not found"
ErrorDocument 500 "Internal server error"
